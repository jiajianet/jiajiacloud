<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="bootstrap.min.css">

	<!-- Loding font -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,700" rel="stylesheet">

	<!-- Custom Styles -->
	<link rel="stylesheet" type="text/css" href="./styles.css">

	<title>登录</title>
</head>

<body>

	<!-- Backgrounds -->

	<div id="login-bg" class="container-fluid">

		<div class="bg-img"></div>
		<div class="bg-color"></div>
	</div>

	<!-- End Backgrounds -->

	<div class="container" id="login">
		<div class="row justify-content-center">
			<div class="col-lg-8">
				<div class="login">

					<h1>贾贾网络开发者授权登录</h1>

					<!-- Loging form -->
					<form>
						<div class="form-group">
							<input class="form-control" id="username" aria-describedby="emailHelp" placeholder="输入帐户">

						</div>
						<div class="form-group">
							<input type="password" class="form-control" id="password" placeholder="输入密码">
						</div>

						<div class="form-check">

							<label class="forgot-password"><a href="#">忘记密码<a></label>

						</div>

						<br>
						<button onclick="JavaScript:LoginSubmit()" class="btn btn-lg btn-block btn-success">登录</button>
					</form>
					<!-- End Loging form -->
				</div>
			</div>
		</div>


</body>
<script type="text/javascript" src="./js/api.js"></script>
<script>
	apiready = function () {

		loginerror = function () {
			var dialogBox = api.require('dialogBox');
			dialogBox.raffle({
				texts: {
					title: '帐户或密码不正确',
					mainText: '您输入的帐户或密码错误',
					subText: '请重新输入',
					rightTitle: '确定'
				},
				styles: {

					bg: '#fff',
					w: 300,
					corner: 16,
					title: {
						size: 14,
						color: '#000',
						marginT: 20
					},
					icon: {
						marginT: 20,
						w: 40,
						h: 40,
						iconPath: 'widget://pages/main_cart/images/lockerror.png'
					},
					main: {
						marginT: 20,
						color: '#636363',
						size: 13
					},
					sub: {
						marginT: 8,
						color: '#999999',
						size: 12
					},

					right: {
						marginB: 7,
						marginL: 85,
						w: 130,
						h: 35,
						corner: 2,
						bg: '#fff',
						color: '#007FFF',
						size: 12
					}
				},

			}, function (ret, err) {
				if (ret) {
					var dialogBox = api.require('dialogBox');
					dialogBox.close({
						dialogName: 'raffle'
					});

				} else {
					alert("出错了");
				}
			});
		}
		LoginSubmit = function () {
			var username = $api.val($api.byId('username'));
			var password = $api.val($api.byId('password'));



			api.ajax({
				url: "https://jiajiacloud.vercel.app/jcc/api/user/develop" + username + "/config.html",
				method: 'GET',
				dataType: 'json'
			}, function (ret, err) {

				if (ret) {
					//console.log(ret);
					var passwdCorrect = ret.Paasword
					var AccountStatus = ret.status
					var usrName = ret.UserName
					console.log(passwdCorrect)
					console.log(AccountStatus)
					console.log(usrName)



				} else {
					loginerror();
				}
			});

			api.loadSecureValue({
				key: 'developPasswordDecrypt'
			}, function (ret, err) {
				var decryptKey = ret.value;
				var signature = api.require('signature');
				signature.aesDecode({
					data: password,
					key: decryptKey
				}, function (ret, err) {
					if (ret.status) {
						alert(JSON.stringify(ret));
					} else {
						loginerror();
					}
				});
			});
		}

	}
</script>

</html>